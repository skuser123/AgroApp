<!DOCTYPE html>
<html lang="en">

    <head>
        <!-- basic -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- mobile metas -->
        <meta name="viewport" content="width=device-width, initial-scale=2">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
        <!-- site metas -->
        <title>Agrobot</title>
        <meta name="keywords" content="">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- bootstrap css -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <!-- style css -->
        <link rel="stylesheet" href="css/style.css">
        <!-- Responsive-->
        <link rel="stylesheet" href="css/responsive.css">
        <!-- fevicon -->
        <link rel="icon" href="images/logo.png" type="image/gif" />
        <!-- Tweaks for older IEs-->
        <link rel="stylesheet" href="css/owl.carousel.min.css">
        <link rel="stylesheet"
            href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
        <link rel="stylesheet" href="css/bootstrap-datepicker.min.css">
        <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    </head>
    <!-- body -->

    <body class="main-layout">
        <style>
        .ext_header {
            font-size: 24px;
            color: #6b7908;
            line-height: 30px;
            font-weight: bold;
            display: block;
            text-transform: uppercase;
        }

        figure {
            text-align: center;
        }

        .services_box h3 {
            font-size: 20px !important;
        }

        .services_box figure img{
            margin-top: 15px !important;
            height: 130px;
        }

        img{
            max-width: 60%;

            /* max-height: 200px; */
        }
        .hidden {
            display: none;
        }

        .spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 0.71s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #preloader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        button[type="submit"], .manual_btn {
            position: relative;
            left: 30%;
        }
    </style>
    <div class="full_bg">
        <!-- header -->
        <header class="header-area">
            <div class="container-fluid">
                <div class="row d_flex">
                    <div class=" col-md-2 col-sm-3">
                        <div class="logo m-3">
                            <!-- <a href="index.html">Agro<span>Pro</span></a> -->
                            <a href="/">
                                <img src="images/logo.png" width="200"
                                    alt="Agrobot Logo" srcset="">
                            </a>
                        </div>
                    </div>
                    <div class="col-md-8 col-sm-9">
                        <div class="navbar-area">
                            <nav class="site-navbar">
                                <ul>
                                    <li><a href="index.html">Home</a></li>
                                    <li><a target="_blank" href="wiki.html">Wiki
                                        </a></li>
                                    <li><a target="_blank"
                                            href="https://market.agrobotfarms.com/">Marketplace</a></li>
                                    <li><a href="extensions.html">Extensions</a></li>
                                    <li><a class="active" href="detect.html">Detect</a></li>
                                    <li><a href="analysis.html">Analysis</a></li>
                                    <li><a href="charts.html">Charts</a></li> 
                                </ul>
                                <button class="nav-toggler">
                                    <span></span>
                                </button>
                            </nav>
                        </div>
                    </div>
                    <div class="col-md-2 padd_0 d_none">
                        <ul class="email text_align_right">
                        </ul>
                    </div>
                </div>
            </div>
        </header>

    </div>

    <!-- services -->
    <div class="services mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="titlepage text_align_left">
                        <h2 class="mb-3">DETECT</h2>
                    </div>
                </div>
            </div>
            <div class="row" id="mainContent">
                <div class="col-md-6">   
                    <div class="services_box_main">
                        <div class="services_box text_align_left">
                            <figure><img style="max-width: 100%;"
                                    src="images/robot.jpg" alt="#"></figure>
                            <div class="veget">
                                <a class="read_more automatic_button" href="#">Automatic</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="services_box text_align_left" id="services-box">
                        <figure><img src="images/type.jpg" alt="#"></figure>
                        <div class="veget">
                            <a class="read_more manual_btn" href="#" onclick="showForm()">Manual</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row hidden" id="mainResult">
            </div>
            <div id="preloader" class="hidden">
                <div class="spinner"></div>
            </div>

        </div>

    </div>

        <!--  footer -->
    <footer>
        <div class="footer mt-5">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-6">
                        <div class="hedingh3  text_align_left">
                            <h3>Newsletter</h3>
                            <form id="colof" class="form_subscri">
                                <input class="newsl" placeholder="Enter Email" type="text" name="Email">
                                <button class="subsci_btn"><img src="images/new.png" alt="#" /></button>
                            </form>

                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="hedingh3 text_align_center">
                            <h3> Explore</h3>
                            <ul class="menu_footer">
                                <li><a href="/">Home</a></li>
                                <li><a href="wiki.html">Wiki</a></li>
                                <li><a href="https://market.agrobotfarms.com/">Marketplace</a></li>
                                <li><a href="extensions.html">Extensions</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="hedingh3  flot_right text_align_left">
                            <h3>ContacT</h3>
                            <ul class="top_infomation">
                                <li><i class="fa fa-phone" aria-hidden="true"></i>
                                    (+234) 8111109159
                                </li>
                                <li><i class="fa fa-phone" aria-hidden="true"></i>
                                    (+234) 81111 09159
                                </li>
                                <li><i class="fa fa-envelope" aria-hidden="true"></i>
                                    <a href="Javascript:void(0)">hello@agrobotfarms.com</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>



            <div class="copyright">
                <div class="container">
                    <div class="row d_flex">
                        <div class="col-md-8">
                            <p>Â© <span id="year"></span> All Rights Reserved.</a>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <ul class="social_icon ">
                                <li><a href="Javascript:void(0)"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                </li>
                                <li><a href="Javascript:void(0)"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                </li>
                                <li><a href="Javascript:void(0)"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- end footer -->
    <!-- Javascript files-->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.0.0.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/bootstrap-datepicker.min.js"></script>
    <script src="js/custom.js"></script>
    <script>
        var date = new Date();
        var date = date.getFullYear();

        var element = document.getElementById('year');
        element.innerText = date;
    </script>
    <script>
        $(document).ready(function() {
            $('.automatic_button').click(function() {
                $('#mainContent').hide();
                $('#preloader').show();
                $('.services').css('height', '600px');
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        var latitude = position.coords.latitude;
                        var longitude = position.coords.longitude;

                        callAjax(latitude, longitude);

                    });
                } else {
                    alert("Geolocation is not supported by this browser.");
                }
            });
        });

    </script>

        <script>
            function showForm() {
                const servicesBox = document.getElementById('services-box');

                const form = document.createElement('form');
                const labelLat = document.createElement('label');
                const inputLat = document.createElement('input');
                const labelLng = document.createElement('label');
                const inputLng = document.createElement('input');
                const submitBtn = document.createElement('button');

                form.setAttribute('onsubmit', 'sendAjax(event)');
                labelLat.innerText = 'Latitude:';
                labelLat.classList.add('form-label');
                inputLat.classList.add('form-control');
                inputLat.setAttribute('type', 'text');
                inputLat.setAttribute('required', 'required');
                inputLat.setAttribute('name', 'latitude');
                labelLng.innerText = 'Longitude:';
                labelLng.classList.add('form-label');
                inputLng.classList.add('form-control');
                inputLng.setAttribute('type', 'text');
                inputLng.setAttribute('required', 'required');
                inputLng.setAttribute('name', 'longitude');
                submitBtn.classList.add('read_more');
                submitBtn.classList.add('mt-4', 'mb-4');
                submitBtn.setAttribute('type', 'submit');
                submitBtn.innerText = 'Submit';

                form.appendChild(labelLat);
                form.appendChild(inputLat);
                form.appendChild(labelLng);
                form.appendChild(inputLng);
                form.appendChild(submitBtn);

                servicesBox.innerHTML = '';
                servicesBox.classList.add('card', 'p-3')
                servicesBox.appendChild(form);
            }
        </script>

    <script>
        function callAjax(latitude, longitude) {
            $.ajax({
                url: "https://crop-recommendation-gzhmfjnevq-uc.a.run.app/data_dump",
                type: "POST",
                data: JSON.stringify({ lat: parseInt(latitude), lon: parseInt(longitude) }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",

                success: function(data) {
                    var body = `<div class="col-md-6">
                            <div class="card result">
                                <div class="card-header">
                                    Climate Data
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title">Location: ` + data['#### climate ####'].name + `</h5>
                                    <p class="card-text">Temperature: `+ data['#### climate ####'].main.temp +`</p>
                                    <p class="card-text">Humidity: `+ data['#### climate ####'].main.humidity +`</p>
                                    <p class="card-text">Wind Speed: ` + data['#### climate ####'].wind.speed +`</p>
                                    <p class="card-text">Pressure: ` + data['#### climate ####'].main.pressure + `</p>
                                    <p class="card-text">Weather Description: ` + data['#### climate ####'].weather[0].description + `</p>
                                </div>
                            </div>
                            <div class="card mt-3 result">
                                <div class="card-header">
                                    Note
                                </div>
                                <div class="card-body">
                                    <p>` + data['#### Description ####'] + `</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                        <div class="card mb-3 result">
                                <div class="card-header">
                                    Details (Input)
                                </div>
                                <div class="card-body">
                                    <p class="card-text">Latitude: ` + data['#### Soil ####'][0].Lat + ` (` + latitude + `)</p>
                                    <p class="card-text">Longitude: ` + data['#### Soil ####'][0].Long + ` (` + longitude + `)</p>
                                </div>
                            </div>
                            <div class="card result">
                                <div class="card-header">
                                    Soil Data
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title">Project: ` + data['#### Soil ####'][0].project + `</h5>
                                    <h5 class="card-title">Farm: ` + data['#### Soil ####'][0].Farm + `</h5>
                                    <p class="card-text">pH: ` + data['#### Soil ####'][0].pH + `</p>
                                    <p class="card-text">P: ` + data['#### Soil ####'][0].P + `</p>
                                    <p class="card-text">Ca: ` + data['#### Soil ####'][0].Ca + `</p>
                                    <p class="card-text">Cu: ` + data['#### Soil ####'][0].Cu + `</p>
                                    <p class="card-text">Mg: ` + data['#### Soil ####'][0].Mg + `</p>
                                    <p class="card-text">Mn: ` + data['#### Soil ####'][0].Mn + `</p>
                                    <p class="card-text">N: ` + data['#### Soil ####'][0].N + `</p>
                                    <p class="card-text">Na: ` + data['#### Soil ####'][0].Na + `</p>
                                    <p class="card-text">Zn: ` + data['#### Soil ####'][0].Zn + `</p>
                                </div>
                            </div>
                        </div>`;

                    $('#mainResult').html(body);
                    $('#preloader').hide();
                    $('#mainResult').css('display', 'flex');
                    $('.services').css('height', 'auto');

                    console.log(data);
                },
                error: function(xhr, status, error) {
                    console.error(status + ": " + error);
                    $('#mainContent').show();
                    $('#preloader').hide();
                    $('.services').css('height', 'auto');
                }
            });
        }

        function sendAjax(event) {
            event.preventDefault();
            $('#mainContent').hide();
            $('#preloader').show();
            $('.services').css('height', '600px');
            const formData = new FormData(event.target);
            const latitude = formData.get('latitude');
            const longitude = formData.get('longitude');

            callAjax(latitude, longitude);
        }
    </script>

        </body>
</html>